<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rocket Run Pro: Mestre do Espaço (Mobile Ready)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        /* CORREÇÃO 1: Bloqueia a rolagem do corpo da página em dispositivos móveis */
        body {
            /* Resto do seu código... */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #0a0014;
            font-family: Arial, sans-serif;
            color: white;
            overflow: hidden; /* ESSENCIAL: Evita barras de rolagem desnecessárias */
            /* Garante que o body ocupe todo o viewport */
            width: 100vw; 
            height: 100vh;
            touch-action: none; /* CORREÇÃO ROBUSTA: Impede o navegador de lidar com o toque como rolagem ou zoom */
        }
        canvas {
            display: block;
            border-radius: 12px;
            box-shadow: 0 0 30px rgba(255, 50, 50, 0.5); 
            cursor: pointer;
            /* Garante que a área do canvas não seja rolada */
            touch-action: none; 
        }

        /* [Seu CSS restante...] */
        .menu-container, .game-over-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 30px;
            background: rgba(0, 0, 0, 0.85);
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
            text-align: center;
            z-index: 100;
            touch-action: auto; /* Permite o toque nos botões do menu */
        }

        .menu-container h1, .game-over-container h1 {
            color: #ff9900;
            margin-bottom: 25px;
            font-size: 2.5rem;
        }

        .difficulty-button, .restart-button {
            display: block;
            width: 250px;
            padding: 15px 20px;
            margin: 15px auto;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .difficulty-button:hover, .restart-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }

        .easy { background-color: #00A389; color: white; } 
        .medium { background-color: #ffc107; color: #333; } 
        .insane { background-color: #F44336; color: white; } 
        
        .game-over-container h2 {
            color: #F44336;
            margin: 15px 0;
            font-size: 1.8rem;
        }
        .score-display {
            font-size: 1.4rem;
            color: #ccc;
            margin-bottom: 20px;
        }
        .score-display span {
            color: #ffc107;
            font-size: 1.8rem;
            font-weight: bold;
        }
        .hidden {
            display: none;
        }

        #controls-instruction {
            position: absolute;
            bottom: 20px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            z-index: 10;
        }
    </style>
</head>
<body>

    <div id="menu-screen" class="menu-container">
        <h1>ROCKET RUN PRO</h1>
        <p>SELECIONE O NÍVEL DE DIFICULDADE</p>
        <button class="difficulty-button easy" onclick="startGame('easy')">FÁCIL</button>
        <button class="difficulty-button medium" onclick="startGame('medium')">MÉDIO</button>
        <button class="difficulty-button insane" onclick="startGame('insane')">ESTOU LOUCO (só para loucos)</button>
    </div>

    <div id="gameover-screen" class="game-over-container hidden">
        <h1>MISSÃO FALHOU</h1>
        <h2 id="gameover-reason"></h2>
        <div class="score-display">
            Pontuação: <span id="final-score">0</span>
        </div>
        <div class="score-display">
            Recorde: <span id="high-score">0</span>
        </div>
        <button class="restart-button easy" onclick="showMenu()">REINICIAR</button>
    </div>

    <div id="controls-instruction">
        Controles: WASD ou SETAS (Mover), Clique/Toque/ESPAÇO (Impulso Extra Contínuo)
    </div>
    
    <script>
        // [Suas variáveis globais... (mantidas)]
        let rocketX;
        let rocketY; 
        let rocketXVel = 0;
        let rocketYVel = 0;
        let combustivel;
        const MAX_COMBUSTIVEL = 100;
        const CONSUMO_POR_FRAME = 0.05;
        let asteroides = [];
        let score = 0;
        let gameState = 'menu';
        let motivoFimDeJogo = "";
        let highScore = 0;
        let estrelas = [];
        let currentDifficulty = 'easy';
        let asteroideLargura = 50;
        let isBoostActive = false; 
        let messageOverlay = null;
        let messageTimer = 0;
        const MESSAGE_DURATION = 180;
        let keys = {};
        let lastActionTime = 0; 
        let autoPilotActive = false;
        const AUTOPILOT_DELAY = 120;
        
        // [Sua configuração de dificuldade e mensagens (mantidas)]
        const DIFICULDADE_CONFIG = { /* ... */ };
        const MENSAGENS_MOTIVACIONAIS = [ /* ... */ ];


        // =========================================================
        // FUNÇÕES DE SETUP E INPUT (CORRIGIDAS)
        // =========================================================

        function setup() {
            // Responsividade
            let w = min(800, windowWidth);
            let h = min(450, windowHeight);
            let canvas = createCanvas(w, h); 
            canvas.parent(document.body);
            
            // Previne o menu de contexto do botão direito e o comportamento padrão no toque
            // O `touch-action: none` no CSS é mais robusto, mas mantemos este aqui também
            canvas.elt.addEventListener('contextmenu', e => e.preventDefault()); 

            // Carrega o recorde salvo (localStorage)
            let savedScore = localStorage.getItem('rocketRunHighScore');
            if (savedScore !== null) {
                highScore = parseInt(savedScore);
            }
            
            // Configurações de Texto e Estilo Base
            textAlign(CENTER, CENTER);
            textFont('Arial'); 
            noStroke(); 
            frameRate(60); 
            
            // Inicializa Estrelas
            for(let i = 0; i < 150; i++) {
                estrelas.push({ x: random(width), y: random(height), size: random(1, 3), speed: random(0.5, 2) });
            }
            
            // Oculta o canvas ao iniciar para mostrar o menu
            canvas.elt.style.display = 'none';
        }

        // [Sua função showMenu (mantida)]
        function showMenu() { /* ... */ }
        
        // [Sua função startGame (mantida)]
        function startGame(difficulty) { /* ... */ }

        // [Sua função draw (mantida)]
        function draw() { /* ... */ }


        // --- EVENTOS DE TECLADO (mantidos) ---
        function keyPressed() { /* ... */ }
        function keyReleased() { /* ... */ }
        
        // --- EVENTOS DE MOUSE/TOQUE (Corrigidos para Mobile) ---

        function mousePressed(event) {
            // Garante que o toque/clique só funcione dentro do canvas
            if (mouseX >= 0 && mouseX <= width && mouseY >= 0 && mouseY <= height) {
                if (gameState === 'running') {
                    isBoostActive = true; 
                }
            }

            // Retorna ao menu se estiver em gameover, no clique
            if (gameState === 'gameover') {
                showMenu();
            }
        }

        function mouseReleased() {
            if (gameState === 'running') {
                isBoostActive = false;
            }
        }
        
        function touchStarted(event) {
            // CORREÇÃO 2: Usa 'touches' para checar se o toque ocorreu DENTRO do canvas
            // O p5.js mapeia o primeiro toque para mouseX/mouseY
            if (touches.length > 0) {
                 // Checa se o toque está dentro dos limites do canvas (opcional, mas bom)
                 if (mouseX >= 0 && mouseX <= width && mouseY >= 0 && mouseY <= height) {
                    if (gameState === 'running') {
                        isBoostActive = true; // Inicia o impulso contínuo
                    }
                }
            }

            // Retorna ao menu se estiver em gameover, no toque
            if (gameState === 'gameover') {
                showMenu();
            }
            
            // CORREÇÃO ROBUSTA: Retorna false para evitar que o navegador processe o evento
            return false; 
        }

        function touchEnded() {
             if (gameState === 'running') {
                isBoostActive = false; // Para o impulso contínuo
            }
             // CORREÇÃO ROBUSTA: Retorna false para evitar que o navegador processe o evento
             return false;
        }


        // [Sua função windowResized (mantida)]
        function windowResized() { /* ... */ }

        // [Suas funções de Jogo, Desenho e a Classe Asteroide (mantidas)]
        function endGame(motivo) { /* ... */ }
        function drawMessageOverlay() { /* ... */ }
        function drawBackgroundGradient() { /* ... */ }
        function drawStars() { /* ... */ }
        function drawHUD() { /* ... */ }
        function drawFuelGauge(x, y, h, w) { /* ... */ }
        function desenharFoguete(x, y, tamanho) { /* ... */ }
        class Asteroide { /* ... */ }
    </script>
</body>
</html>
