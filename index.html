<!DOCTYPE html>
<html lang="pt-BR">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â  Â  <title>Rocket Run Pro: Mestre do EspaÃ§o</title>
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
Â  Â  <style>
Â  Â  Â  Â  /* Estilos bÃ¡sicos para centralizar o canvas e tornÃ¡-lo responsivo (MANTIDO) */
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  background-color: #0a0014;
Â  Â  Â  Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  overflow: hidden; /* Evita barras de rolagem desnecessÃ¡rias */
Â  Â  Â  Â  Â  Â  /* IMPORTANTE: Adiciona 'position: relative' ao body para posicionar os botÃµes */
Â  Â  Â  Â  Â  Â  position: relative;
            /* CORREÃ‡ÃƒO CRÃTICA: Desativa o zoom e a rolagem no nÃ­vel do body */
            touch-action: manipulation;
Â  Â  Â  Â  }
Â  Â  Â  Â  canvas {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 30px rgba(255, 50, 50, 0.5); /* Efeito neon vermelho */
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Estilos do Menu e Game Over (MANTIDO) */
Â  Â  Â  Â  .menu-container, .game-over-container {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 50%;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  Â  Â  Â  padding: 30px;
Â  Â  Â  Â  Â  Â  background: rgba(0, 0, 0, 0.85);
Â  Â  Â  Â  Â  Â  border-radius: 15px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  z-index: 100;
Â  Â  Â  Â  }

Â  Â  Â  Â  .menu-container h1, .game-over-container h1 { color: #ff9900; margin-bottom: 25px; font-size: 2.5rem; }
Â  Â  Â  Â  .difficulty-button, .restart-button { display: block; width: 250px; padding: 15px 20px; margin: 15px auto; border: none; border-radius: 8px; font-size: 1.2rem; font-weight: bold; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s; }
Â  Â  Â  Â  .difficulty-button:hover, .restart-button:hover { transform: translateY(-3px); box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3); }
Â  Â  Â  Â  .easy { background-color: #00A389; color: white; }
Â  Â  Â  Â  .medium { background-color: #ffc107; color: #333; }
Â  Â  Â  Â  .insane { background-color: #F44336; color: white; }
Â  Â  Â  Â  .game-over-container h2 { color: #F44336; margin: 15px 0; font-size: 1.8rem; }
Â  Â  Â  Â  .score-display { font-size: 1.4rem; color: #ccc; margin-bottom: 20px; }
Â  Â  Â  Â  .score-display span { color: #ffc107; font-size: 1.8rem; font-weight: bold; }
Â  Â  Â  Â  .hidden { display: none; }
Â  Â  Â  Â  #controls-instruction {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  bottom: 5px; /* Mais para baixo para nÃ£o cobrir o D-Pad */
Â  Â  Â  Â  Â  Â  color: rgba(255, 255, 255, 0.7);
Â  Â  Â  Â  Â  Â  font-size: 0.8rem; /* Menor para economizar espaÃ§o */
Â  Â  Â  Â  Â  Â  z-index: 10;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* NOVO: Estilos para o D-Pad (Controles MÃ³veis) */
Â  Â  Â  Â  #mobile-controls {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  bottom: 10px;
Â  Â  Â  Â  Â  Â  left: 10px;
Â  Â  Â  Â  Â  Â  z-index: 20; /* Fica acima de tudo */
Â  Â  Â  Â  Â  Â  display: none; /* Inicialmente oculto. Exibido apenas no jogo */
Â  Â  Â  Â  }

Â  Â  Â  Â  .control-button {
Â  Â  Â  Â  Â  Â  width: 55px;
Â  Â  Â  Â  Â  Â  height: 55px;
Â  Â  Â  Â  Â  Â  margin: 5px;
Â  Â  Â  Â  Â  Â  border: 3px solid #ff9900;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  background-color: rgba(255, 153, 0, 0.3);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  font-size: 1.5rem;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  line-height: 50px;
Â  Â  Â  Â  Â  Â  user-select: none; /* Evita seleÃ§Ã£o de texto no toque */
Â  Â  Â  Â  Â  Â  touch-action: manipulation; /* CORREÃ‡ÃƒO: Essencial para evitar zoom/rolagem apenas nos botÃµes */
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: background-color 0.1s;
Â  Â  Â  Â  }

Â  Â  Â  Â  .control-button:active {
Â  Â  Â  Â  Â  Â  background-color: rgba(255, 153, 0, 0.8);
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 10px #ff9900;
Â  Â  Â  Â  }

Â  Â  Â  Â  #left-button { float: left; }
Â  Â  Â  Â  #right-button { float: left; margin-left: 0; } /* Alinha com o botÃ£o 'left' */
Â  Â  Â  Â  #up-button { clear: both; margin: 5px auto; display: block; width: 125px; border-radius: 8px; height: 35px; line-height: 30px; font-size: 1.2rem; }

Â  Â  Â  Â  /* NOVO: Classe para forÃ§ar a exibiÃ§Ã£o do D-Pad */
Â  Â  Â  Â  .show-mobile-controls { display: block !important; }

Â  Â  </style>
</head>
<body>

Â  Â  <div id="menu-screen" class="menu-container">
Â  Â  Â  Â  <h1>ROCKET RUN PRO</h1>
Â  Â  Â  Â  <p>SELECIONE O NÃVEL DE DIFICULDADE</p>
Â  Â  Â  Â  <button class="difficulty-button easy" onclick="startGame('easy')">FÃCIL</button>
Â  Â  Â  Â  <button class="difficulty-button medium" onclick="startGame('medium')">MÃ‰DIO</button>
Â  Â  Â  Â  <button class="difficulty-button insane" onclick="startGame('insane')">ESTOU LOUCO (sÃ³ para loucos)</button>
Â  Â  </div>

Â  Â  <div id="gameover-screen" class="game-over-container hidden">
Â  Â  Â  Â  <h1>MISSÃƒO FALHOU</h1>
Â  Â  Â  Â  <h2 id="gameover-reason"></h2>
Â  Â  Â  Â  <div class="score-display">
Â  Â  Â  Â  Â  Â  PontuaÃ§Ã£o: <span id="final-score">0</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="score-display">
Â  Â  Â  Â  Â  Â  Recorde: <span id="high-score">0</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <button class="restart-button easy" onclick="showMenu()">REINICIAR</button>
Â  Â  </div>

Â  Â  <div id="controls-instruction">
Â  Â  Â  Â  Controles PC: WASD ou SETAS (Mover), Clique/ESPAÃ‡O (Impulso Extra). Controles Celular: D-Pad (Mover), Toque (Impulso Extra ContÃ­nuo).
Â  Â  </div>

Â  Â  <div id="mobile-controls">
Â  Â  Â  Â  <div id="up-button" class="control-button"
Â  Â  Â  Â  Â  Â  ontouchstart="controlButtonDown('w'); return false;" ontouchend="controlButtonUp('w'); return false;"
Â  Â  Â  Â  Â  Â  onmousedown="controlButtonDown('w')" onmouseup="controlButtonUp('w')">
Â  Â  Â  Â  Â  Â  PROPULSOR
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <div id="left-button" class="control-button"
Â  Â  Â  Â  Â  Â  Â  Â  ontouchstart="controlButtonDown('a'); return false;" ontouchend="controlButtonUp('a'); return false;"
Â  Â  Â  Â  Â  Â  Â  Â  onmousedown="controlButtonDown('a')" onmouseup="controlButtonUp('a')">
Â  Â  Â  Â  Â  Â  Â  Â  &#9664;
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div id="right-button" class="control-button"
Â  Â  Â  Â  Â  Â  Â  Â  ontouchstart="controlButtonDown('d'); return false;" ontouchend="controlButtonUp('d'); return false;"
Â  Â  Â  Â  Â  Â  Â  Â  onmousedown="controlButtonDown('d')" onmouseup="controlButtonUp('d')">
Â  Â  Â  Â  Â  Â  Â  Â  &#9654;
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  </div>
Â  Â  <script>
Â  Â  Â  Â  // Global (MANTIDO)
Â  Â  Â  Â  let rocketX;
Â  Â  Â  Â  let rocketY;
Â  Â  Â  Â  let rocketXVel = 0;
Â  Â  Â  Â  let rocketYVel = 0;
Â  Â  Â  Â  let combustivel;
Â  Â  Â  Â  const MAX_COMBUSTIVEL = 100;
Â  Â  Â  Â  const CONSUMO_POR_FRAME = 0.05;
Â  Â  Â  Â  let asteroides = [];
Â  Â  Â  Â  let score = 0;
Â  Â  Â  Â  let gameState = 'menu';
Â  Â  Â  Â  let motivoFimDeJogo = "";
Â  Â  Â  Â  let highScore = 0;
Â  Â  Â  Â  let estrelas = [];
Â  Â  Â  Â  let currentDifficulty = 'easy';
Â  Â  Â  Â  let asteroideLargura = 50;

Â  Â  Â  Â  // NOVO: Estado para controle de clique/toque (Impulso Extra ContÃ­nuo)
Â  Â  Â  Â  let isBoostActive = false;

Â  Â  Â  Â  // VariÃ¡veis para Mensagem Motivacional
Â  Â  Â  Â  let messageOverlay = null;
Â  Â  Â  Â  let messageTimer = 0;
Â  Â  Â  Â  const MESSAGE_DURATION = 180;
Â  Â  Â  Â  let keys = {}; // Estado das teclas pressionadas (usado tambÃ©m pelos botÃµes virtuais)

Â  Â  Â  Â  // VariÃ¡veis para Autopilot (AssistÃªncia InvisÃ­vel - EASY mode)
Â  Â  Â  Â  let lastActionTime = 0;
Â  Â  Â  Â  let autoPilotActive = false;
Â  Â  Â  Â  const AUTOPILOT_DELAY = 120;

Â  Â  Â  Â  // VariÃ¡veis que MUDAM por DIFICULDADE (MANTIDO)
Â  Â  Â  Â  let gravidade;
Â  Â  Â  Â  let asteroideAbertura;
Â  Â  Â  Â  let velocidadeJogo;
Â  Â  Â  Â  let y_thrust;
Â  Â  Â  Â  let x_thrust;
Â  Â  Â  Â  let max_speed;
Â  Â  Â  Â  let drag;

Â  Â  Â  Â  // Lista de 40 Mensagens Motivacionais (MANTIDO)
Â  Â  Â  Â  const MENSAGENS_MOTIVACIONAIS = [
Â  Â  Â  Â  Â  Â  "Uau! VocÃª Ã© um Ã¡s da pilotagem! Avance para o prÃ³ximo setor.",
Â  Â  Â  Â  Â  Â  "ImpecÃ¡vel! Seu histÃ³rico de voo Ã© perfeito. Continue assim!",
Â  Â  Â  Â  Â  Â  "Setor de Meio de Jogo: VocÃª Ã© imparÃ¡vel. A lenda diz que poucos chegam aqui!",
Â  Â  Â  Â  Â  Â  "Meta de 100 atingida! A velocidade da luz nÃ£o Ã© pÃ¡reo para vocÃª.",
Â  Â  Â  Â  Â  Â  "Excelente manobra! Nem um grÃ£o de poeira espacial te parou.",
Â  Â  Â  Â  Â  Â  "Lenda em formaÃ§Ã£o! O universo inteiro assiste ao seu voo.",
Â  Â  Â  Â  Â  Â  "ğŸš€ Modo Turbo Ativado! Continue desviando com essa precisÃ£o.",
Â  Â  Â  Â  Â  Â  "Dupla Centena! Seu controle Ã© absoluto. Mantenha o curso!",
Â  Â  Â  Â  Â  Â  "Pilotagem nÃ­vel mestre. O prÃ³ximo desafio espera!",
Â  Â  Â  Â  Â  Â  "Um Quarto do Caminho! IncrÃ­vel! A recompensa estÃ¡ prÃ³xima.",
Â  Â  Â  Â  Â  Â  "A gravidade obedece a vocÃª. Siga em frente, comandante!",
Â  Â  Â  Â  Â  Â  "TrÃªs Centenas! VocÃª estÃ¡ reescrevendo as regras da fÃ­sica.",
Â  Â  Â  Â  Â  Â  "PrecisÃ£o Absoluta! Seu nome serÃ¡ gravado nas estrelas.",
Â  Â  Â  Â  Â  Â  "Que Voo! VocÃª nem parece precisar de combustÃ­vel.",
Â  Â  Â  Â  Â  Â  "Setor CrÃ­tico Superado! Nada pode te derrubar agora.",
Â  Â  Â  Â  Â  Â  "Quatro Centenas! VocÃª estÃ¡ voando mais rÃ¡pido que a informaÃ§Ã£o.",
Â  Â  Â  Â  Â  Â  "Seu foco Ã© lendÃ¡rio. Continue com essa determinaÃ§Ã£o.",
Â  Â  Â  Â  Â  Â  "Mais um salto quÃ¢ntico em sua pontuaÃ§Ã£o! ParabÃ©ns!",
Â  Â  Â  Â  Â  Â  "NÃ­vel de Reflexo: Divino! Mal posso acompanhar sua velocidade.",
Â  Â  Â  Â  Â  Â  "MEIO MILHÃƒO DE PONTOS! (Meio caminho para a glÃ³ria!)",
Â  Â  Â  Â  Â  Â  "Retorno Triunfal! O universo inteiro celebra seu sucesso.",
Â  Â  Â  Â  Â  Â  "Maestria Total! Seu foguete parece deslizar no vÃ¡cuo.",
Â  Â  Â  Â  Â  Â  "Nem mesmo um buraco negro ousaria te desafiar. Siga!",
Â  Â  Â  Â  Â  Â  "Seis Centenas! Que desempenho monumental.",
Â  Â  Â  Â  Â  Â  "VocÃª Ã© um GÃªnio TÃ¡tico! Seus movimentos sÃ£o perfeitos.",
Â  Â  Â  Â  Â  Â  "O Painel de Controle estÃ¡ em Ãªxtase com sua performance.",
Â  Â  Â  Â  Â  Â  "Onde vocÃª aprendeu a voar assim? Absolutamente fabuloso!",
Â  Â  Â  Â  Â  Â  "Sete Centenas! A meta estÃ¡ logo ali, Ã  vista!",
Â  Â  Â  Â  Â  Â  "PrÃ³ximo NÃ­vel de ConsciÃªncia: VocÃª Ã© a prÃ³pria estrela.",
Â  Â  Â  Â  Â  Â  "TrÃªs Quartos do Caminho! A perseveranÃ§a compensa.",
Â  Â  Â  Â  Â  Â  "LanÃ§amento Bem Sucedido! Prepare-se para o final Ã©pico.",
Â  Â  Â  Â  Â  Â  "Oito Centenas! Os Deuses da Astrologia estÃ£o impressionados.",
Â  Â  Â  Â  Â  Â  "VocÃª estÃ¡ em outra dimensÃ£o de pilotagem. Continue a magia!",
Â  Â  Â  Â  Â  Â  "Ãšltima Barreira de Setor! VocÃª consegue ver o final?",
Â  Â  Â  Â  Â  Â  "Recorde de Velocidade Quebrado! Apenas vocÃª e o infinito.",
Â  Â  Â  Â  Â  Â  "Nove Centenas! Faltam apenas 100 para a Lenda!",
Â  Â  Â  Â  Â  Â  "VocÃª estÃ¡ respirando no espaÃ§o com facilidade! Quase lÃ¡!",
Â  Â  Â  Â  Â  Â  "O CÃ©u NÃ£o Ã‰ o Limite! Continue ultrapassando expectativas.",
Â  Â  Â  Â  Â  Â  "PRÃ“XIMA PARADA: GLÃ“RIA! Apenas mais um passo...",
Â  Â  Â  Â  Â  Â  "ğŸŒŸ NÃVEL LENDÃRIO ATINGIDO! VocÃª Ã© o MESTRE DO ESPAÃ‡O! ğŸŒŸ"
Â  Â  Â  Â  ];


Â  Â  Â  Â  const DIFICULDADE_CONFIG = {
Â  Â  Â  Â  Â  Â  'easy': {
Â  Â  Â  Â  Â  Â  Â  Â  grav: 0.1,
Â  Â  Â  Â  Â  Â  Â  Â  abert: 200,
Â  Â  Â  Â  Â  Â  Â  Â  y_thrust: -0.7,
Â  Â  Â  Â  Â  Â  Â  Â  x_thrust: 0.5,
Â  Â  Â  Â  Â  Â  Â  Â  max_speed: 4,
Â  Â  Â  Â  Â  Â  Â  Â  scroll_base: 2,
Â  Â  Â  Â  Â  Â  Â  Â  drag: 0.98,
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  'medium': {
Â  Â  Â  Â  Â  Â  Â  Â  grav: 0.4,
Â  Â  Â  Â  Â  Â  Â  Â  abert: 140,
Â  Â  Â  Â  Â  Â  Â  Â  y_thrust: -1.0,
Â  Â  Â  Â  Â  Â  Â  Â  x_thrust: 0.8,
Â  Â  Â  Â  Â  Â  Â  Â  max_speed: 6,
Â  Â  Â  Â  Â  Â  Â  Â  scroll_base: 4,
Â  Â  Â  Â  Â  Â  Â  Â  drag: 0.97,
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  'insane': {
Â  Â  Â  Â  Â  Â  Â  Â  grav: 0.8,
Â  Â  Â  Â  Â  Â  Â  Â  abert: 100,
Â  Â  Â  Â  Â  Â  Â  Â  y_thrust: -1.3,
Â  Â  Â  Â  Â  Â  Â  Â  x_thrust: 1.2,
Â  Â  Â  Â  Â  Â  Â  Â  max_speed: 8,
Â  Â  Â  Â  Â  Â  Â  Â  scroll_base: 7,
Â  Â  Â  Â  Â  Â  Â  Â  drag: 0.96,
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };

Â  Â  Â  Â  // =========================================================
Â  Â  Â  Â  // FUNÃ‡Ã•ES DE SETUP E MENU
Â  Â  Â  Â  // =========================================================

Â  Â  Â  Â  function setup() {
Â  Â  Â  Â  Â  Â  let w = min(800, windowWidth);
Â  Â  Â  Â  Â  Â  let h = min(450, windowHeight);
Â  Â  Â  Â  Â  Â  let canvas = createCanvas(w, h);
Â  Â  Â  Â  Â  Â  canvas.parent(document.body);

Â  Â  Â  Â  Â  Â  // Previne o menu de contexto do botÃ£o direito e o comportamento padrÃ£o no toque
Â  Â  Â  Â  Â  Â  canvas.elt.addEventListener('contextmenu', e => e.preventDefault());
Â  Â  Â  Â  Â  Â  // CORREÃ‡ÃƒO: Adiciona 'touch-action: none' ao canvas para garantir que ele nÃ£o seja arrastÃ¡vel
Â  Â  Â  Â  Â  Â  canvas.elt.style.touchAction = 'none';

Â  Â  Â  Â  Â  Â  let savedScore = localStorage.getItem('rocketRunHighScore');
Â  Â  Â  Â  Â  Â  if (savedScore !== null) {
Â  Â  Â  Â  Â  Â  Â  Â  highScore = parseInt(savedScore);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  textAlign(CENTER, CENTER);
Â  Â  Â  Â  Â  Â  textFont('Arial');
Â  Â  Â  Â  Â  Â  noStroke();
Â  Â  Â  Â  Â  Â  frameRate(60);

Â  Â  Â  Â  Â  Â  for(let i = 0; i < 150; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  estrelas.push({ x: random(width), y: random(height), size: random(1, 3), speed: random(0.5, 2) });
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  canvas.elt.style.display = 'none';
Â  Â  Â  Â  Â  Â  // Chama a funÃ§Ã£o para verificar e mostrar/ocultar o D-Pad
Â  Â  Â  Â  Â  Â  checkAndToggleMobileControls();
Â  Â  Â  Â  }

Â  Â  Â  Â  // NOVO: FunÃ§Ã£o para verificar o tipo de dispositivo e exibir os controles mÃ³veis (MANTIDO)
Â  Â  Â  Â  function checkAndToggleMobileControls() {
Â  Â  Â  Â  Â  Â  const isMobile = window.matchMedia("only screen and (max-width: 760px)").matches ||
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
Â  Â  Â  Â  Â  Â  const mobileControls = document.getElementById('mobile-controls');

Â  Â  Â  Â  Â  Â  if (isMobile && gameState === 'running') {
Â  Â  Â  Â  Â  Â  Â  Â  mobileControls.classList.add('show-mobile-controls');
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('controls-instruction').classList.add('hidden'); // Oculta a instruÃ§Ã£o de texto no celular
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  mobileControls.classList.remove('show-mobile-controls');
Â  Â  Â  Â  Â  Â  Â  Â  if (gameState === 'menu' || gameState === 'gameover') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('controls-instruction').classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function showMenu() {
Â  Â  Â  Â  Â  Â  gameState = 'menu';
Â  Â  Â  Â  Â  Â  document.getElementById('menu-screen').classList.remove('hidden');
Â  Â  Â  Â  Â  Â  document.getElementById('gameover-screen').classList.add('hidden');
Â  Â  Â  Â  Â  Â  let canvas = select('canvas');
Â  Â  Â  Â  Â  Â  if (canvas) canvas.elt.style.display = 'none';
Â  Â  Â  Â  Â  Â  checkAndToggleMobileControls(); // Oculta os controles mÃ³veis no menu
Â  Â  Â  Â  }

Â  Â  Â  Â  function startGame(difficulty) {
Â  Â  Â  Â  Â  Â  currentDifficulty = difficulty;
Â  Â  Â  Â  Â  Â  const config = DIFICULDADE_CONFIG[difficulty];

Â  Â  Â  Â  Â  Â  gravidade = config.grav;
Â  Â  Â  Â  Â  Â  asteroideAbertura = config.abert;
Â  Â  Â  Â  Â  Â  y_thrust = config.y_thrust;
Â  Â  Â  Â  Â  Â  x_thrust = config.x_thrust;
Â  Â  Â  Â  Â  Â  max_speed = config.max_speed;
Â  Â  Â  Â  Â  Â  drag = config.drag;

Â  Â  Â  Â  Â  Â  rocketX = width / 4;
Â  Â  Â  Â  Â  Â  rocketY = height / 2;
Â  Â  Â  Â  Â  Â  rocketXVel = 0;
Â  Â  Â  Â  Â  Â  rocketYVel = 0;
Â  Â  Â  Â  Â  Â  asteroides = [];
Â  Â  Â  Â  Â  Â  score = 0;
Â  Â  Â  Â  Â  Â  combustivel = MAX_COMBUSTIVEL;
Â  Â  Â  Â  Â  Â  asteroides.push(new Asteroide());
Â  Â  Â  Â  Â  Â  gameState = 'running';
Â  Â  Â  Â  Â  Â  messageOverlay = null;
Â  Â  Â  Â  Â  Â  keys = {};
Â  Â  Â  Â  Â  Â  isBoostActive = false;

Â  Â  Â  Â  Â  Â  lastActionTime = frameCount;
Â  Â  Â  Â  Â  Â  autoPilotActive = false;

Â  Â  Â  Â  Â  Â  document.getElementById('menu-screen').classList.add('hidden');
Â  Â  Â  Â  Â  Â  document.getElementById('gameover-screen').classList.add('hidden');
Â  Â  Â  Â  Â  Â  document.getElementById('controls-instruction').classList.add('hidden');
Â  Â  Â  Â  Â  Â  let canvas = select('canvas');
Â  Â  Â  Â  Â  Â  if (canvas) canvas.elt.style.display = 'block';

Â  Â  Â  Â  Â  Â  checkAndToggleMobileControls(); // Exibe os controles mÃ³veis no jogo

Â  Â  Â  Â  Â  Â  loop();
Â  Â  Â  Â  }

Â  Â  Â  Â  function draw() {
Â  Â  Â  Â  Â  Â  if (gameState === 'menu') {
Â  Â  Â  Â  Â  Â  Â  Â  drawBackgroundGradient();
Â  Â  Â  Â  Â  Â  Â  Â  drawStars();
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  drawBackgroundGradient();
Â  Â  Â  Â  Â  Â  drawStars();

Â  Â  Â  Â  Â  Â  if (gameState === 'running') {

Â  Â  Â  Â  Â  Â  Â  Â  // --- 1. APLICAÃ‡ÃƒO DOS CONTROLES (FORÃ‡AS) ---

Â  Â  Â  Â  Â  Â  Â  Â  // Checa a condiÃ§Ã£o de Impulso Extra (4x mais forte)
Â  Â  Â  Â  Â  Â  Â  Â  // Se ESPAÃ‡O (32) OU Clique/Toque (isBoostActive) estiver ativo
Â  Â  Â  Â  Â  Â  Â  Â  const highBoostCondition = (keys[' '] || keys[32] || isBoostActive);

Â  Â  Â  Â  Â  Â  Â  Â  if (highBoostCondition) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Impulso extra contÃ­nuo (mais forte)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rocketYVel += y_thrust * 4.0;
Â  Â  Â  Â  Â  Â  Â  Â  } else if (keys['w'] || keys['W'] || keys['ArrowUp']) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Impulso padrÃ£o (mais fraco) se o boost nÃ£o estiver ativo
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rocketYVel += y_thrust;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // Vertical (Baixo ou Seta para Baixo)
Â  Â  Â  Â  Â  Â  Â  Â  // O botÃ£o 'propulsor' substitui 'W'/'ArrowUp' e 'S'/'ArrowDown' nÃ£o tem botÃ£o virtual
Â  Â  Â  Â  Â  Â  Â  Â  if (keys['s'] || keys['S'] || keys['ArrowDown']) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rocketYVel -= y_thrust * 0.5;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // Horizontal (Frente/TrÃ¡s ou D/A)
Â  Â  Â  Â  Â  Â  Â  Â  let rightThrustApplied = false;
Â  Â  Â  Â  Â  Â  Â  Â  if (keys['d'] || keys['D'] || keys['ArrowRight']) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rocketXVel += x_thrust;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rightThrustApplied = true;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  if (keys['a'] || keys['A'] || keys['ArrowLeft']) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rocketXVel -= x_thrust;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // VariÃ¡vel para checar se o jogador estÃ¡ fazendo QUALQUER coisa
Â  Â  Â  Â  Â  Â  Â  Â  let anyPlayerAction = (keys['w'] || keys['W'] || keys['ArrowUp'] || keys['s'] || keys['S'] || keys['ArrowDown'] || keys['a'] || keys['A'] || rightThrustApplied || highBoostCondition);


Â  Â  Â  Â  Â  Â  Â  Â  // --- LÃ“GICA DO PILOTO AUTOMÃTICO (AssistÃªncia InvisÃ­vel) - MANTIDA ---
Â  Â  Â  Â  Â  Â  Â  Â  if (currentDifficulty === 'easy') {

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (anyPlayerAction) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  autoPilotActive = false;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  lastActionTime = frameCount;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (frameCount > lastActionTime + AUTOPILOT_DELAY) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  autoPilotActive = true;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (autoPilotActive) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rocketXVel += x_thrust * 0.2;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // --- 2. FÃSICA E ATUALIZAÃ‡ÃƒO DE VELOCIDADE (MANTIDO) ---

Â  Â  Â  Â  Â  Â  Â  Â  rocketYVel += gravidade;
Â  Â  Â  Â  Â  Â  Â  Â  rocketXVel *= drag;
Â  Â  Â  Â  Â  Â  Â  Â  rocketYVel *= drag;

Â  Â  Â  Â  Â  Â  Â  Â  rocketXVel = constrain(rocketXVel, -max_speed, max_speed);
Â  Â  Â  Â  Â  Â  Â  Â  rocketYVel = constrain(rocketYVel, -max_speed, max_speed);

Â  Â  Â  Â  Â  Â  Â  Â  rocketX += rocketXVel;
Â  Â  Â  Â  Â  Â  Â  Â  rocketY += rocketYVel;

Â  Â  Â  Â  Â  Â  Â  Â  rocketX = constrain(rocketX, 15, width - 15);
Â  Â  Â  Â  Â  Â  Â  Â  rocketY = constrain(rocketY, 15, height - 15);

Â  Â  Â  Â  Â  Â  Â  Â  // --- 3. MOVIMENTO DO MUNDO (MANTIDO) ---

Â  Â  Â  Â  Â  Â  Â  Â  let xFactor = map(rocketX, width / 4, width - 15, 0, 1.5);
Â  Â  Â  Â  Â  Â  Â  Â  velocidadeJogo = DIFICULDADE_CONFIG[currentDifficulty].scroll_base + xFactor;

Â  Â  Â  Â  Â  Â  Â  Â  // GESTÃƒO DO COMBUSTÃVEL
Â  Â  Â  Â  Â  Â  Â  Â  let currentConsumption = CONSUMO_POR_FRAME * (anyPlayerAction ? 2 : 1);

Â  Â  Â  Â  Â  Â  Â  Â  combustivel -= currentConsumption;
Â  Â  Â  Â  Â  Â  Â  Â  combustivel = constrain(combustivel, 0, MAX_COMBUSTIVEL);

Â  Â  Â  Â  Â  Â  Â  Â  if (combustivel <= 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  endGame("ACABOU O COMBUSTÃVEL!");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // --- 4. LÃ“GICA DE ASTEROIDES E COLISÃƒO (MANTIDO) ---

Â  Â  Â  Â  Â  Â  Â  Â  desenharFoguete(rocketX, rocketY, 30);

Â  Â  Â  Â  Â  Â  Â  Â  for (let i = asteroides.length - 1; i >= 0; i--) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  asteroides[i].mover(velocidadeJogo);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  asteroides[i].desenhar();

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (asteroides[i].checkCollision(rocketX, rocketY, 15)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  endGame("COLISÃƒO COM ASTEROIDE!");
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (asteroides[i].x < -asteroideLargura) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  asteroides.splice(i, 1);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // LÃ“GICA DE PONTUAÃ‡ÃƒO
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (!asteroides[i].scored && rocketX > asteroides[i].x + asteroideLargura) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  score++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  combustivel = MAX_COMBUSTIVEL;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  asteroides[i].scored = true;

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // LÃ³gica de Mensagens Motivacionais
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (score > 0 && score % 25 === 0 && score <= 1000) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let index = (score / 25) - 1;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (index < MENSAGENS_MOTIVACIONAIS.length) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  messageOverlay = MENSAGENS_MOTIVACIONAIS[index];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  messageTimer = MESSAGE_DURATION;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // Gera novos asteroides
Â  Â  Â  Â  Â  Â  Â  Â  let spawnInterval = max(30, 100 - (velocidadeJogo * 5));
Â  Â  Â  Â  Â  Â  Â  Â  if (frameCount % floor(spawnInterval) === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  asteroides.push(new Asteroide());
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  drawHUD();

Â  Â  Â  Â  Â  Â  } else if (gameState === 'gameover') {
Â  Â  Â  Â  Â  Â  Â  Â  desenharFoguete(rocketX, rocketY, 30);
Â  Â  Â  Â  Â  Â  Â  Â  drawHUD();
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  if (messageOverlay !== null) {
Â  Â  Â  Â  Â  Â  Â  Â  drawMessageOverlay();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // =========================================================
Â  Â  Â  Â  // FUNÃ‡Ã•ES DE INPUT (CORRIGIDAS/REFORÃ‡ADAS)
Â  Â  Â  Â  // =========================================================

Â  Â  Â  Â  // NOVO: FunÃ§Ãµes para simular keypress usando os botÃµes HTML (MANTIDO)
Â  Â  Â  Â  function controlButtonDown(keyName) {
Â  Â  Â  Â  Â  Â  if (gameState === 'running') {
Â  Â  Â  Â  Â  Â  Â  Â  // Mapeia o nome da tecla para o objeto 'keys'
Â  Â  Â  Â  Â  Â  Â  Â  keys[keyName] = true;
Â  Â  Â  Â  Â  Â  Â  Â  // Evita que o toque no botÃ£o ative o impulso extra contÃ­nuo do touchStarted
Â  Â  Â  Â  Â  Â  Â  Â  if (keyName === 'w') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  isBoostActive = false;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function controlButtonUp(keyName) {
Â  Â  Â  Â  Â  Â  if (gameState === 'running') {
Â  Â  Â  Â  Â  Â  Â  Â  keys[keyName] = false;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function keyPressed() {
Â  Â  Â  Â  Â  Â  if (gameState === 'running') {
Â  Â  Â  Â  Â  Â  Â  Â  keys[key] = true;
Â  Â  Â  Â  Â  Â  Â  Â  keys[keyCode] = true; // Para setas e ESPAÃ‡O (32)
Â  Â  Â  Â  Â  Â  } else if (gameState === 'gameover' && (key === ' ' || keyCode === 32)) {
Â  Â  Â  Â  Â  Â  Â  Â  showMenu();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return false; // CORREÃ‡ÃƒO: Bloqueia o comportamento padrÃ£o do teclado no p5
Â  Â  Â  Â  }

Â  Â  Â  Â  function keyReleased() {
Â  Â  Â  Â  Â  Â  if (gameState === 'running') {
Â  Â  Â  Â  Â  Â  Â  Â  keys[key] = false;
Â  Â  Â  Â  Â  Â  Â  Â  keys[keyCode] = false;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return false;
Â  Â  Â  Â  }

Â  Â  Â  Â  // --- EVENTOS DE MOUSE/TOQUE (REFORÃ‡ADOS) ---

Â  Â  Â  Â  function mousePressed() {
Â  Â  Â  Â  Â  Â  // Verifica se o toque/clique NÃƒO foi em um dos botÃµes do D-Pad
Â  Â  Â  Â  Â  Â  if (gameState === 'running' && mouseY < height) { // Checa se o clique foi dentro do canvas
Â  Â  Â  Â  Â  Â  Â  Â  isBoostActive = true; // Inicia o impulso contÃ­nuo
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  if (gameState === 'gameover') {
Â  Â  Â  Â  Â  Â  Â  Â  showMenu();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return false; // CORREÃ‡ÃƒO: ESSENCIAL no mousePressed para o navegador
Â  Â  Â  Â  }

Â  Â  Â  Â  function mouseReleased() {
Â  Â  Â  Â  Â  Â  if (gameState === 'running') {
Â  Â  Â  Â  Â  Â  Â  Â  isBoostActive = false; // Para o impulso contÃ­nuo
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return false; // CORREÃ‡ÃƒO: Essencial
Â  Â  Â  Â  }

Â  Â  Â  Â  function touchStarted() {
Â  Â  Â  Â  Â  Â  // Evita o toque duplo nos botÃµes (embora ontouchstart no HTML jÃ¡ ajude)
Â  Â  Â  Â  Â  Â  if (gameState === 'running' && touches.length > 0 && touches[0].y < height) {
Â  Â  Â  Â  Â  Â  Â  Â  // CORREÃ‡ÃƒO/AJUSTE: Garante que o toque no canvas (fora dos botÃµes virtuais) ative o boost
                // A lÃ³gica para verificar se o toque foi em um botÃ£o HTML (D-Pad) seria mais complexa aqui,
                // mas 'isBoostActive = false' em controlButtonDown() jÃ¡ minimiza o conflito.
Â  Â  Â  Â  Â  Â  Â  Â  isBoostActive = true;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  if (gameState === 'gameover') {
Â  Â  Â  Â  Â  Â  Â  Â  showMenu();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return false; // CORREÃ‡ÃƒO: ESSENCIAL. Bloqueia a rolagem/zoom do navegador no inÃ­cio do toque.
Â  Â  Â  Â  }

Â  Â  Â  Â  function touchMoved() {
Â  Â  Â  Â  Â  Â  // CORREÃ‡ÃƒO: Adicionada essa funÃ§Ã£o, pois 'touchStarted' sÃ³ bloqueia o primeiro toque,
Â  Â  Â  Â  Â  Â  // e 'touchMoved' impede o deslizar/arrastar do canvas.
Â  Â  Â  Â  Â  Â  return false;
Â  Â  Â  Â  }

Â  Â  Â  Â  function touchEnded() {
Â  Â  Â  Â  Â  Â  Â if (gameState === 'running') {
Â  Â  Â  Â  Â  Â  Â  Â  isBoostActive = false; // Para o impulso contÃ­nuo
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  return false; // CORREÃ‡ÃƒO: Essencial.
Â  Â  Â  Â  }


Â  Â  Â  Â  // =========================================================
Â  Â  Â  Â  // FUNÃ‡Ã•ES DE RESPONSIVIDADE (MODIFICADAS para chamar o check)
Â  Â  Â  Â  // =========================================================
Â  Â  Â  Â  function windowResized() {
Â  Â  Â  Â  Â  Â  let w = min(800, windowWidth);
Â  Â  Â  Â  Â  Â  let h = min(450, windowHeight);
Â  Â  Â  Â  Â  Â  resizeCanvas(w, h);
Â  Â  Â  Â  Â  Â  let canvas = select('canvas');
Â  Â  Â  Â  Â  Â  if (canvas) {
Â  Â  Â  Â  Â  Â  Â  Â  canvas.elt.style.left = `${(windowWidth - w) / 2}px`;
Â  Â  Â  Â  Â  Â  Â  Â  canvas.elt.style.top = `${(windowHeight - h) / 2}px`;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  checkAndToggleMobileControls(); // Reajusta a exibiÃ§Ã£o dos controles mÃ³veis
Â  Â  Â  Â  }

Â  Â  Â  Â  // =========================================================
Â  Â  Â  Â  // FUNÃ‡Ã•ES DE JOGO, DESENHO, CLASSE ASTEROIDE (MANTIDAS)
Â  Â  Â  Â  // =========================================================

Â  Â  Â  Â  function endGame(motivo) {
Â  Â  Â  Â  Â  Â  motivoFimDeJogo = motivo;
Â  Â  Â  Â  Â  Â  gameState = 'gameover';

Â  Â  Â  Â  Â  Â  if (score > highScore) {
Â  Â  Â  Â  Â  Â  Â  Â  highScore = score;
Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('rocketRunHighScore', highScore);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  noLoop();

Â  Â  Â  Â  Â  Â  document.getElementById('gameover-reason').innerText = motivoFimDeJogo;
Â  Â  Â  Â  Â  Â  document.getElementById('final-score').innerText = score;
Â  Â  Â  Â  Â  Â  document.getElementById('high-score').innerText = highScore;
Â  Â  Â  Â  Â  Â  document.getElementById('gameover-screen').classList.remove('hidden');

Â  Â  Â  Â  Â  Â  checkAndToggleMobileControls(); // Oculta os controles mÃ³veis no Game Over
Â  Â  Â  Â  }

Â  Â  Â  Â  function drawMessageOverlay() {
Â  Â  Â  Â  Â  Â  if (messageTimer > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  push();
Â  Â  Â  Â  Â  Â  Â  Â  let alpha = 255;
Â  Â  Â  Â  Â  Â  Â  Â  if (messageTimer < 60) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alpha = map(messageTimer, 0, 60, 0, 255);
Â  Â  Â  Â  Â  Â  Â  Â  } else if (messageTimer > MESSAGE_DURATION - 60) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  alpha = map(messageTimer, MESSAGE_DURATION - 60, MESSAGE_DURATION, 0, 255);
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  fill(0, 0, 0, 200);
Â  Â  Â  Â  Â  Â  Â  Â  rect(0, height / 2 - 50, width, 100);

Â  Â  Â  Â  Â  Â  Â  Â  textSize(28 * (width / 800));
Â  Â  Â  Â  Â  Â  Â  Â  fill(255, 200, 0, alpha);
Â  Â  Â  Â  Â  Â  Â  Â  text(messageOverlay, width / 2, height / 2);

Â  Â  Â  Â  Â  Â  Â  Â  messageTimer--;
Â  Â  Â  Â  Â  Â  Â  Â  if (messageTimer <= 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  messageOverlay = null;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  pop();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function drawBackgroundGradient() {
Â  Â  Â  Â  Â  Â  push();
Â  Â  Â  Â  Â  Â  for (let y = 0; y < height; y++) {
Â  Â  Â  Â  Â  Â  Â  Â  let inter = map(y, 0, height, 0, 1);
Â  Â  Â  Â  Â  Â  Â  Â  let c = lerpColor(color(10, 0, 20), color(50, 0, 0), inter);
Â  Â  Â  Â  Â  Â  Â  Â  stroke(c);
Â  Â  Â  Â  Â  Â  Â  Â  line(0, y, width, y);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  pop();
Â  Â  Â  Â  }

Â  Â  Â  Â  function drawStars() {
Â  Â  Â  Â  Â  Â  push();
Â  Â  Â  Â  Â  Â  fill(255);
Â  Â  Â  Â  Â  Â  for (let i = 0; i < estrelas.length; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  let star = estrelas[i];

Â  Â  Â  Â  Â  Â  Â  Â  star.x -= star.speed * velocidadeJogo * 0.5;

Â  Â  Â  Â  Â  Â  Â  Â  if (star.x < 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  star.x = width;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  star.y = random(height);
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  let c = (i % 5 === 0) ? color(255, 255, 255) : color(255, 100, 0, 150);
Â  Â  Â  Â  Â  Â  Â  Â  fill(c);
Â  Â  Â  Â  Â  Â  Â  Â  ellipse(star.x, star.y, star.size, star.size);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  pop();
Â  Â  Â  Â  }

Â  Â  Â  Â  function drawHUD() {
Â  Â  Â  Â  Â  Â  push();
Â  Â  Â  Â  Â  Â  textSize(20 * (width / 800));
Â  Â  Â  Â  Â  Â  fill(255, 255, 255);
Â  Â  Â  Â  Â  Â  text("FOGUETE EM FUGA: ROTA DE SOBREVIVÃŠNCIA", width / 2, 25);

Â  Â  Â  Â  Â  Â  textSize(24 * (width / 800));
Â  Â  Â  Â  Â  Â  fill(255, 200, 0);
Â  Â  Â  Â  Â  Â  text(`SCORE: ${score}`, width - 100 * (width / 800), 60);

Â  Â  Â  Â  Â  Â  textSize(18 * (width / 800));
Â  Â  Â  Â  Â  Â  fill(255, 255, 255);
Â  Â  Â  Â  Â  Â  text(`RECORD: ${highScore}`, width - 100 * (width / 800), 90);

Â  Â  Â  Â  Â  Â  let nivel = currentDifficulty.toUpperCase();
Â  Â  Â  Â  Â  Â  let corNivel;
Â  Â  Â  Â  Â  Â  if (currentDifficulty === 'easy') {
Â  Â  Â  Â  Â  Â  Â  Â  corNivel = color(100, 255, 100);
Â  Â  Â  Â  Â  Â  } else if (currentDifficulty === 'medium') {
Â  Â  Â  Â  Â  Â  Â  Â  corNivel = color(255, 255, 0);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  corNivel = color(255, 50, 50);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  fill(corNivel);
Â  Â  Â  Â  Â  Â  textSize(18 * (width / 800));
Â  Â  Â  Â  Â  Â  text(`MODO: ${nivel}`, 100 * (width / 800), 60);

Â  Â  Â  Â  Â  Â  drawFuelGauge(40 * (width / 800), 90, 15, 200 * (width / 800));

Â  Â  Â  Â  Â  Â  textSize(14 * (width / 800));
Â  Â  Â  Â  Â  Â  fill(200, 200, 255);
Â  Â  Â  Â  Â  Â  text(`VELOCIDADE: ${nf(velocidadeJogo, 1, 1)}`, 100 * (width / 800), 115);

Â  Â  Â  Â  Â  Â  pop();
Â  Â  Â  Â  }

Â  Â  Â  Â  function drawFuelGauge(x, y, h, w) {
Â  Â  Â  Â  Â  Â  push();
Â  Â  Â  Â  Â  Â  textSize(14 * (width / 800));
Â  Â  Â  Â  Â  Â  fill(255);
Â  Â  Â  Â  Â  Â  text("COMBUSTÃVEL", x + w/2, y - 5);

Â  Â  Â  Â  Â  Â  fill(50);
Â  Â  Â  Â  Â  Â  stroke(255);
Â  Â  Â  Â  Â  Â  strokeWeight(1);
Â  Â  Â  Â  Â  Â  rect(x, y, w, h, 5);

Â  Â  Â  Â  Â  Â  let fuelWidth = map(combustivel, 0, MAX_COMBUSTIVEL, 0, w);

Â  Â  Â  Â  Â  Â  let fuelColor;
Â  Â  Â  Â  Â  Â  if (combustivel < 20) {
Â  Â  Â  Â  Â  Â  Â  Â  fuelColor = color(255, 0, 0);
Â  Â  Â  Â  Â  Â  } else if (combustivel < 50) {
Â  Â  Â  Â  Â  Â  Â  Â  fuelColor = color(255, 255, 0);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  fuelColor = color(0, 200, 0);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  noStroke();
Â  Â  Â  Â  Â  Â  fill(fuelColor);
Â  Â  Â  Â  Â  Â  rect(x + 1, y + 1, fuelWidth - 2, h - 2, 4);

Â  Â  Â  Â  Â  Â  pop();
Â  Â  Â  Â  }

Â  Â  Â  Â  function desenharFoguete(x, y, tamanho) {
Â  Â  Â  Â  Â  Â  push();

Â  Â  Â  Â  Â  Â  let rastroAlpha = map(combustivel, 0, MAX_COMBUSTIVEL, 50, 255);
Â  Â  Â  Â  Â  Â  let trailLength = map(rocketYVel, -max_speed, max_speed, 10, 20);

Â  Â  Â  Â  Â  Â  let rotationAngle = map(rocketYVel, -max_speed, max_speed, radians(-20), radians(20));

Â  Â  Â  Â  Â  Â  translate(x, y);
Â  Â  Â  Â  Â  Â  rotate(rotationAngle);

Â  Â  Â  Â  Â  Â  // Rastro de PropulsÃ£o (Baseado no Y, para dar a sensaÃ§Ã£o de impulso para cima)
Â  Â  Â  Â  Â  Â  if (rocketYVel < 0 || keys['w'] || keys['W'] || keys['ArrowUp'] || isBoostActive || keys[' '] || keys[32]) {
Â  Â  Â  Â  Â  Â  Â  Â  fill(255, 150, 0, rastroAlpha);
Â  Â  Â  Â  Â  Â  Â  Â  ellipse(-tamanho/2 - 5, 0, 10 + random(0, 5), 15 + random(0, 10));
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  // Rastro Lateral (Baseado no X, para dar a sensaÃ§Ã£o de impulso lateral)
Â  Â  Â  Â  Â  Â  if (keys['a'] || keys['A'] || keys['ArrowLeft']) {
Â  Â  Â  Â  Â  Â  Â  Â  fill(0, 200, 255, rastroAlpha * 0.5); // Azul para freio
Â  Â  Â  Â  Â  Â  Â  Â  rect(tamanho/2 - 5, -tamanho/2, 5, tamanho);
Â  Â  Â  Â  Â  Â  } else if (keys['d'] || keys['D'] || keys['ArrowRight'] || (currentDifficulty === 'easy' && autoPilotActive)) {
Â  Â  Â  Â  Â  Â  Â  Â  fill(255, 100, 0, rastroAlpha * 0.5); // Laranja para aceleraÃ§Ã£o (inclui Autopilot no rastro)
Â  Â  Â  Â  Â  Â  Â  Â  rect(-tamanho/2 - 5, -tamanho/2, 5, tamanho);
Â  Â  Â  Â  Â  Â  }


Â  Â  Â  Â  Â  Â  // Corpo do Foguete com Sombra
Â  Â  Â  Â  Â  Â  noStroke();
Â  Â  Â  Â  Â  Â  fill(100);
Â  Â  Â  Â  Â  Â  triangle(-tamanho/2 + 2, tamanho/2 + 2, -tamanho/2 + 2, -tamanho/2 + 2, tamanho/2 + 2, 2);

Â  Â  Â  Â  Â  Â  fill(180); // Cor principal
Â  Â  Â  Â  Â  Â  triangle(-tamanho/2, -tamanho/2, -tamanho/2, tamanho/2, tamanho/2, 0);

Â  Â  Â  Â  Â  Â  // Ponta Vermelha
Â  Â  Â  Â  Â  Â  fill(200, 50, 50);
Â  Â  Â  Â  Â  Â  triangle(tamanho/2, 0, tamanho/2 - 5, -5, tamanho/2 - 5, 5);

Â  Â  Â  Â  Â  Â  pop();
Â  Â  Â  Â  }

Â  Â  Â  Â  // =========================================================
Â  Â  Â  Â  // CLASSE ASTEROIDE (MANTIDA)
Â  Â  Â  Â  // =========================================================

Â  Â  Â  Â  class Asteroide {
Â  Â  Â  Â  Â  Â  constructor() {
Â  Â  Â  Â  Â  Â  Â  Â  this.x = width;
Â  Â  Â  Â  Â  Â  Â  Â  this.centroAbertura = random(asteroideAbertura / 2 + 30, height - asteroideAbertura / 2 - 30);
Â  Â  Â  Â  Â  Â  Â  Â  this.topo = this.centroAbertura - asteroideAbertura / 2;
Â  Â  Â  Â  Â  Â  Â  Â  this.fundo = this.centroAbertura + asteroideAbertura / 2;
Â  Â  Â  Â  Â  Â  Â  Â  this.scored = false;

Â  Â  Â  Â  Â  Â  Â  Â  // Adiciona a variaÃ§Ã£o de y para o asterÃ³ide se mover (mantido)
Â  Â  Â  Â  Â  Â  Â  Â  this.yOffset = random(-30, 30);
Â  Â  Â  Â  Â  Â  Â  Â  this.ySpeed = random(0.5, 1.5) * (random() > 0.5 ? 1 : -1);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  mover(velocidade) {
Â  Â  Â  Â  Â  Â  Â  Â  this.x -= velocidade;
Â  Â  Â  Â  Â  Â  Â  Â  // Movimento senoidal para o buraco do asterÃ³ide
Â  Â  Â  Â  Â  Â  Â  Â  this.yOffset += this.ySpeed * 0.1;
Â  Â  Â  Â  Â  Â  Â  Â  if (this.yOffset > 30 || this.yOffset < -30) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  this.ySpeed *= -1;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  this.centroAbertura += this.yOffset * 0.05;
Â  Â  Â  Â  Â  Â  Â  Â  this.centroAbertura = constrain(this.centroAbertura, asteroideAbertura / 2 + 30, height - asteroideAbertura / 2 - 30);
Â  Â  Â  Â  Â  Â  Â  Â  this.topo = this.centroAbertura - asteroideAbertura / 2;
Â  Â  Â  Â  Â  Â  Â  Â  this.fundo = this.centroAbertura + asteroideAbertura / 2;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  desenhar() {
Â  Â  Â  Â  Â  Â  Â  Â  push();
Â  Â  Â  Â  Â  Â  Â  Â  fill(100, 100, 100);
Â  Â  Â  Â  Â  Â  Â  Â  // Asteroide de Cima
Â  Â  Â  Â  Â  Â  Â  Â  rect(this.x, 0, asteroideLargura, this.topo);
Â  Â  Â  Â  Â  Â  Â  Â  // Asteroide de Baixo
Â  Â  Â  Â  Â  Â  Â  Â  rect(this.x, this.fundo, asteroideLargura, height - this.fundo);
Â  Â  Â  Â  Â  Â  Â  Â  pop();
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  checkCollision(rocketX, rocketY, rocketRadius) {
Â  Â  Â  Â  Â  Â  Â  Â  // ColisÃ£o com asteroide de cima
Â  Â  Â  Â  Â  Â  Â  Â  if (rocketX + rocketRadius > this.x && rocketX - rocketRadius < this.x + asteroideLargura) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (rocketY - rocketRadius < this.topo || rocketY + rocketRadius > this.fundo) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return true;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  // ColisÃ£o com bordas do canvas (nÃ£o implementada neste exemplo, mas boa prÃ¡tica)
Â  Â  Â  Â  Â  Â  Â  Â  return false;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  </script>
</body>
</html>
