<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Rocket Run Pro: Mestre do Espaço</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #0a0014;
            font-family: Arial, sans-serif;
            color: white;
            height: 100%;
            width: 100%;
            touch-action: none;
        }
        canvas {
            display: block;
            margin: auto;
            border-radius: 12px;
            box-shadow: 0 0 30px rgba(255, 50, 50, 0.5);
            cursor: pointer;
        }
        .menu-container, .game-over-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 30px;
            background: rgba(0, 0, 0, 0.85);
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.2);
            text-align: center;
            z-index: 100;
        }
        .menu-container h1, .game-over-container h1 {
            color: #ff9900;
            margin-bottom: 25px;
            font-size: 2.5rem;
        }
        .difficulty-button, .restart-button {
            display: block;
            width: 250px;
            padding: 15px 20px;
            margin: 15px auto;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .difficulty-button:hover, .restart-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }
        .easy { background-color: #00A389; color: white; }
        .medium { background-color: #ffc107; color: #333; }
        .insane { background-color: #F44336; color: white; }
        .game-over-container h2 {
            color: #F44336;
            margin: 15px 0;
            font-size: 1.8rem;
        }
        .score-display {
            font-size: 1.4rem;
            color: #ccc;
            margin-bottom: 20px;
        }
        .score-display span {
            color: #ffc107;
            font-size: 1.8rem;
            font-weight: bold;
        }
        .hidden { display: none; }
        #controls-instruction {
            position: absolute;
            bottom: 20px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
            z-index: 10;
            width: 100%;
            text-align: center;
        }
        @media (max-width: 768px) {
            .difficulty-button, .restart-button {
                font-size: 22px;
                padding: 18px 32px;
            }
        }
    </style>
</head>
<body>
    <div id="menu-screen" class="menu-container">
        <h1>ROCKET RUN PRO</h1>
        <p>SELECIONE O NÍVEL DE DIFICULDADE</p>
        <button class="difficulty-button easy" onclick="startGame('easy')">FÁCIL</button>
        <button class="difficulty-button medium" onclick="startGame('medium')">MÉDIO</button>
        <button class="difficulty-button insane" onclick="startGame('insane')">ESTOU LOUCO</button>
    </div>

    <div id="gameover-screen" class="game-over-container hidden">
        <h1>MISSÃO FALHOU</h1>
        <h2 id="gameover-reason"></h2>
        <div class="score-display">Pontuação: <span id="final-score">0</span></div>
        <div class="score-display">Recorde: <span id="high-score">0</span></div>
        <button class="restart-button easy" onclick="showMenu()">REINICIAR</button>
    </div>

    <div id="controls-instruction">
        Controles: WASD ou SETAS (Mover), Clique/Toque/ESPAÇO (Impulso Extra)
    </div>

    <script>
        // === VARIÁVEIS GLOBAIS ===
        let rocketX, rocketY, rocketXVel = 0, rocketYVel = 0;
        let combustivel, asteroides = [], estrelas = [];
        const MAX_COMBUSTIVEL = 100, CONSUMO_POR_FRAME = 0.05;
        let score = 0, highScore = 0, motivoFimDeJogo = "";
        let gameState = 'menu', currentDifficulty = 'easy';
        let isBoostActive = false;
        let gravidade, asteroideAbertura, y_thrust, x_thrust, max_speed, drag, velocidadeJogo;
        const DIFICULDADE_CONFIG = {
            'easy': { grav: 0.1, abert: 200, y_thrust: -0.7, x_thrust: 0.5, max_speed: 4, drag: 0.98, scroll_base: 2 },
            'medium': { grav: 0.4, abert: 140, y_thrust: -1.0, x_thrust: 0.8, max_speed: 6, drag: 0.97, scroll_base: 4 },
            'insane': { grav: 0.8, abert: 100, y_thrust: -1.3, x_thrust: 1.2, max_speed: 8, drag: 0.96, scroll_base: 7 }
        };
        let keys = {};

        // === SETUP ===
        function setup() {
            let canvas = createCanvas(windowWidth, windowHeight);
            canvas.parent(document.body);
            noStroke(); textAlign(CENTER, CENTER);
            let saved = localStorage.getItem('rocketRunHighScore');
            if (saved) highScore = parseInt(saved);
            for (let i = 0; i < 100; i++) estrelas.push({ x: random(width), y: random(height), s: random(1,3) });
            canvas.elt.style.display = 'none';
        }

        // === MENU ===
        function showMenu() {
            gameState = 'menu';
            document.getElementById('menu-screen').classList.remove('hidden');
            document.getElementById('gameover-screen').classList.add('hidden');
            select('canvas').elt.style.display = 'none';
        }

        // === INICIAR JOGO ===
        function startGame(diff) {
            const cfg = DIFICULDADE_CONFIG[diff];
            currentDifficulty = diff;
            gravidade = cfg.grav; asteroideAbertura = cfg.abert; y_thrust = cfg.y_thrust; x_thrust = cfg.x_thrust;
            max_speed = cfg.max_speed; drag = cfg.drag; velocidadeJogo = cfg.scroll_base;
            rocketX = width/4; rocketY = height/2; rocketXVel = rocketYVel = 0;
            combustivel = MAX_COMBUSTIVEL; asteroides = []; score = 0; isBoostActive = false;
            document.getElementById('menu-screen').classList.add('hidden');
            document.getElementById('controls-instruction').classList.add('hidden');
            select('canvas').elt.style.display = 'block';
            gameState = 'running'; loop();
        }

        // === DESENHO PRINCIPAL ===
        function draw() {
            background(10,0,20);
            fill(255);
            estrelas.forEach(s => { ellipse(s.x, s.y, s.s); s.x -= 1; if(s.x<0){s.x=width; s.y=random(height);} });
            if (gameState === 'running') {
                if (keys[' '] || keys[32] || isBoostActive) rocketYVel += y_thrust * 4;
                if (keys['w'] || keys['W'] || keys['ArrowUp']) rocketYVel += y_thrust;
                if (keys['s'] || keys['S'] || keys['ArrowDown']) rocketYVel -= y_thrust * 0.5;
                if (keys['d'] || keys['D'] || keys['ArrowRight']) rocketXVel += x_thrust;
                if (keys['a'] || keys['A'] || keys['ArrowLeft']) rocketXVel -= x_thrust;

                rocketYVel += gravidade;
                rocketXVel *= drag; rocketYVel *= drag;
                rocketXVel = constrain(rocketXVel, -max_speed, max_speed);
                rocketYVel = constrain(rocketYVel, -max_speed, max_speed);
                rocketX += rocketXVel; rocketY += rocketYVel;
                rocketX = constrain(rocketX, 15, width - 15); rocketY = constrain(rocketY, 15, height - 15);
                desenharFoguete(rocketX, rocketY, 30);
                combustivel -= CONSUMO_POR_FRAME;
                if (combustivel <= 0) endGame("Acabou o combustível!");
                drawHUD();
            }
        }

        // === FOGUETE ===
        function desenharFoguete(x, y, t) {
            push(); translate(x, y);
            fill(180); triangle(-t/2, -t/2, -t/2, t/2, t/2, 0);
            fill(255,100,0); triangle(-t/2,0,-t/2-10,-5,-t/2-10,5);
            pop();
        }

        // === HUD ===
        function drawHUD() {
            fill(255); textSize(22);
            text(`SCORE: ${score}`, width-120, 40);
            text(`MODO: ${currentDifficulty.toUpperCase()}`, 120, 40);
        }

        // === GAME OVER ===
        function endGame(msg) {
            motivoFimDeJogo = msg;
            gameState = 'gameover';
            if (score > highScore) { highScore = score; localStorage.setItem('rocketRunHighScore', highScore); }
            noLoop();
            document.getElementById('gameover-reason').innerText = msg;
            document.getElementById('final-score').innerText = score;
            document.getElementById('high-score').innerText = highScore;
            document.getElementById('gameover-screen').classList.remove('hidden');
        }

        // === CONTROLES ===
        function keyPressed(){ keys[key]=true; keys[keyCode]=true; }
        function keyReleased(){ keys[key]=false; keys[keyCode]=false; }
        function mousePressed(){ if(gameState==='running') isBoostActive=true; if(gameState==='gameover') showMenu(); }
        function mouseReleased(){ if(gameState==='running') isBoostActive=false; }
        function touchStarted(){ if(gameState==='running') isBoostActive=true; if(gameState==='gameover') showMenu(); return false; }
        function touchEnded(){ if(gameState==='running') isBoostActive=false; return false; }

        function windowResized(){ resizeCanvas(windowWidth, windowHeight); }
    </script>
</body>
</html>
